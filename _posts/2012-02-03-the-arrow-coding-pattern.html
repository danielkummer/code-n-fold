---
layout: default
title: The Arrow - Coding Pattern?!
date: 2012-02-03 18:00:39.000000000 +01:00
categories:
- Fun
tags:
- abomination
- bad code
- coding pattern
- fun
status: publish
type: post
published: true
meta:
  _edit_last: '29044201'
  publicize_results: a:1:{s:7:"twitter";a:1:{i:219923888;a:2:{s:7:"user_id";s:13:"0r1g4m14dd1c7";s:7:"post_id";s:18:"165480020226211840";}}}
  _wpas_done_twitter: '1'

---
<p>Just as an example of what software engineers like me have to cope with sometimes. I found this nasty little bit of code inside an asp .net project we had to integrate into one of our systems. I won't post the name of the "artist" out of courtesy.</p>
<p>I call it "Coding pattern -<em> The Arrow</em>" -Â just for fun</p>
<p><a href="https://codenfold.files.wordpress.com/2012/02/the_arrow.png"><img src="assets/the_arrow.png" alt="" title="the_arrow" width="500" height="724" class="aligncenter size-full wp-image-110" /></a></p>
<p>Another thing would be "Recursions - how <em>not</em> to do it..."</p>
<p>Got any other name for this abomination of code let me know...</p>
<p>But enough of this bashing, here's the actual code in case you'd like to take a closer look...</p>
<p>[sourcecode]<br />
Sub MakeTreeIncPx(fileContents)</p>
<p>	schSubFolpx objFolder,1, fileContents<br />
	For Each objSubFolder In objFolder.SubFolders<br />
		' subject area<br />
		strcurrentfolder=objsubfolder.name<br />
		schSubFolpx objSubFolder,2, fileContents<br />
		' under subject area<br />
		Set objNextFolder1 = objFSO.GetFolder(objFolder.path &amp; &quot;\&quot; &amp; objsubFolder.name)<br />
		For each nextfolder1 in objNextFolder1.SubFolders<br />
			schSubFolpx nextFolder1,3, fileContents<br />
			Set objNextFolder2 = objFSO.GetFolder(objFolder.path &amp; &quot;\&quot; &amp; objsubFolder.name &amp; &quot;\&quot; &amp; nextfolder1.name)<br />
			For each nextFolder2 in objNextFolder2.SubFolders<br />
				schSubFolpx nextFolder2,4, fileContents<br />
				Set objNextFolder3 = objFSO.GetFolder(objFolder.path &amp; &quot;\&quot; &amp; objsubFolder.name &amp; &quot;\&quot; &amp; nextfolder1.name &amp; &quot;\&quot; &amp; nextfolder2.name)<br />
				For each nextFolder3 in objNextFolder3.SubFolders<br />
					schSubFolpx nextFolder3,5, fileContents<br />
					Set objNextFolder4 = objFSO.GetFolder(objFolder.path &amp; &quot;\&quot; &amp; objsubFolder.name &amp; &quot;\&quot; &amp; nextfolder1.name &amp; &quot;\&quot; &amp; nextfolder2.name &amp; &quot;\&quot; &amp; nextfolder3.name)<br />
					For each nextFolder4 in objNextFolder4.SubFolders<br />
						schSubFolpx nextFolder4,6, fileContents<br />
						Set objNextFolder5 = objFSO.GetFolder(objFolder.path &amp; &quot;\&quot; &amp; objsubFolder.name &amp; &quot;\&quot; &amp; nextfolder1.name &amp; &quot;\&quot; &amp; nextfolder2.name &amp; &quot;\&quot; &amp; nextfolder3.name &amp; &quot;\&quot; &amp; nextfolder4.name)<br />
						For each nextFolder5 in objNextFolder5.SubFolders<br />
							schSubFolpx nextFolder5,7, fileContents<br />
							Set objNextFolder6 = objFSO.GetFolder(objFolder.path &amp; &quot;\&quot; &amp; objsubFolder.name &amp; &quot;\&quot; &amp; nextfolder1.name &amp; &quot;\&quot; &amp; nextfolder2.name &amp; &quot;\&quot; &amp; nextfolder3.name &amp; &quot;\&quot; &amp; nextfolder4.name &amp; &quot;\&quot; &amp; nextfolder5.name)<br />
							For each nextFolder6 in objNextFolder6.SubFolders<br />
								schSubFolpx nextFolder6,8, fileContents<br />
								Set objNextFolder7 = objFSO.GetFolder(objFolder.path &amp; &quot;\&quot; &amp; objsubFolder.name &amp; &quot;\&quot; &amp; nextfolder1.name &amp; &quot;\&quot; &amp; nextfolder2.name &amp; &quot;\&quot; &amp; nextfolder3.name &amp; &quot;\&quot; &amp; nextfolder4.name &amp; &quot;\&quot; &amp; nextfolder5.name &amp; &quot;\&quot; &amp; nextfolder6.name)<br />
								For each nextFolder7 in objNextFolder7.SubFolders<br />
									schSubFolpx nextFolder7,9, fileContents<br />
								next<br />
							next<br />
						next<br />
					next<br />
				next<br />
			next<br />
		next<br />
	Next<br />
	i=0<br />
	while i &lt; folderNo<br />
		i=i+1<br />
		j=0<br />
		if folderPx(i)=2 then<br />
			if folderlev(i)=2 then<br />
				fileContents.Writeline &quot;insDoc(foldersTree, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp;  &quot;))&quot;<br />
			elseif folderlev(i)=3 then<br />
				fileContents.Writeline &quot;insDoc(aux1, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=4 then<br />
				fileContents.Writeline &quot;insDoc(aux2, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=5 then<br />
				fileContents.Writeline &quot;insDoc(aux3, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=6 then<br />
				fileContents.Writeline &quot;insDoc(aux4, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=7 then<br />
				fileContents.Writeline &quot;insDoc(aux5, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=8 then<br />
				fileContents.Writeline &quot;insDoc(aux6, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=9 then<br />
				fileContents.Writeline &quot;insDoc(aux7, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; Folderpath(i) &amp; &quot;))&quot;<br />
			end if</p>
<p>		else 'if folderPx(i)=0 then  ' folder above px or link<br />
			cont=0<br />
			keeplevel=folderlev(i)<br />
			if folderno&gt;i then<br />
				if folderPx(i+1)&gt;0 and folderlev(i+1)&gt; keeplevel then<br />
					cont=1<br />
				else<br />
					if folderno&gt;i+1 and folderlev(i+1)&gt; keeplevel then<br />
						if folderPx(i+2)&gt;0 and folderlev(i+2)&gt; keeplevel then<br />
							cont=2<br />
						else<br />
							if folderno&gt;i+2 and folderlev(i+2)&gt; keeplevel then<br />
								if folderPx(i+3)&gt;0 and folderlev(i+3)&gt; keeplevel then<br />
									cont=3<br />
								else<br />
									if folderno&gt;i+3 and folderlev(i+3)&gt; keeplevel then<br />
										if folderPx(i+4)&gt;0 and folderlev(i+4)&gt; keeplevel then<br />
											cont=4<br />
										else<br />
											if folderno&gt;i+4  and folderlev(i+4)&gt; keeplevel then<br />
												if folderPx(i+5)&gt;0 and folderlev(i+5)&gt; keeplevel then<br />
													cont=5<br />
												else<br />
													if folderno&gt;i+5  and folderlev(i+5)&gt; keeplevel then<br />
														if folderPx(i+6)&gt;0 and folderlev(i+6)&gt; keeplevel then<br />
															cont=6<br />
														else<br />
															if folderno&gt;i+6  and folderlev(i+6)&gt; keeplevel then<br />
																if folderPx(i+7)&gt;0 and folderlev(i+7)&gt; keeplevel then<br />
																	cont=7<br />
																else<br />
																	if folderno&gt;i+7  and folderlev(i+7)&gt; keeplevel then<br />
																		if folderPx(i+8)&gt;0 and folderlev(i+8)&gt; keeplevel then<br />
																			cont=8<br />
																		else<br />
																			if folderno&gt;i+8  and folderlev(i+8)&gt; keeplevel then<br />
																				if folderPx(i+9)&gt;0 and folderlev(i+9)&gt; keeplevel then<br />
																					cont=9<br />
																				else<br />
																					if folderno&gt;i+9  and folderlev(i+9)&gt; keeplevel then<br />
																						if folderPx(i+10)&gt;0 and folderlev(i+10)&gt; keeplevel then<br />
																							cont=10<br />
																						else<br />
																							if folderno&gt;i+10  and folderlev(i+10)&gt; keeplevel then<br />
																								if folderPx(i+11)&gt;0 and folderlev(i+11)&gt; keeplevel then<br />
																									cont=11<br />
																								else<br />
																									if folderno&gt;i+11  and folderlev(i+11)&gt; keeplevel then<br />
																										if folderPx(i+12)&gt;0 and folderlev(i+12)&gt; keeplevel then<br />
																											cont=12<br />
																										else<br />
																											if folderno&gt;i+12  and folderlev(i+12)&gt; keeplevel then<br />
																												if folderPx(i+13)&gt;0 and folderlev(i+13)&gt; keeplevel then<br />
																													cont=13<br />
																												else<br />
																													if folderno&gt;i+13  and folderlev(i+13)&gt; keeplevel then<br />
																														if folderPx(i+14)&gt;0 and folderlev(i+14)&gt; keeplevel then<br />
																															cont=14<br />
																														else<br />
																															if folderno&gt;i+14  and folderlev(i+14)&gt; keeplevel then<br />
																																if folderPx(i+15)&gt;0 and folderlev(i+15)&gt; keeplevel then<br />
																																	cont=15<br />
																																else</p>
<p>																																end if<br />
																															end if<br />
																														end if<br />
																													end if<br />
																												end if<br />
																											end if<br />
																										end if<br />
																									end if<br />
																								end if<br />
																							end if<br />
																						end if<br />
																					end if<br />
																				end if<br />
																			end if<br />
																		end if<br />
																	end if<br />
																end if<br />
															end if<br />
														end if<br />
													end if<br />
												end if<br />
											end if<br />
										end if<br />
									end if<br />
								end if<br />
							end if<br />
						end if<br />
					end if<br />
				end if<br />
			end if<br />
			if cont&gt;0 then<br />
				if folderlev(i)=2 then<br />
					fileContents.Writeline &quot;aux1=insFld(foldersTree, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				elseif folderlev(i) = 3 then<br />
					fileContents.Writeline &quot;aux2=insFld(aux1, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				elseif folderlev(i) = 4 then<br />
					fileContents.Writeline &quot;aux3=insFld(aux2, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				elseif folderlev(i) = 5 then<br />
					fileContents.Writeline &quot;aux4=insFld(aux3, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				elseif folderlev(i) = 6 then<br />
					fileContents.Writeline &quot;aux5=insFld(aux4, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				elseif folderlev(i) = 7 then<br />
					fileContents.Writeline &quot;aux6=insFld(aux5, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				elseif folderlev(i) = 8 then<br />
					fileContents.Writeline &quot;aux7=insFld(aux6, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				elseif folderlev(i) = 9 then<br />
					fileContents.Writeline &quot;aux8=insFld(aux7, gFld(&quot; &amp; chr(34) &amp; FolderName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; &quot;javascript:parent.op()&quot; &amp; chr(34) &amp; &quot;))&quot;<br />
				end if<br />
			end if<br />
		end if<br />
		'if folderPx(i)=1 then   'px folder<br />
		if pxName(i) &lt;&gt; &quot;&quot; then</p>
<p>			if folderlev(i)=2 then<br />
				fileContents.Writeline &quot;insDoc(foldersTree, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot;  &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=3 then<br />
				fileContents.Writeline &quot;insDoc(aux1, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=4 then<br />
				fileContents.Writeline &quot;insDoc(aux2, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=5 then<br />
				fileContents.Writeline &quot;insDoc(aux3, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=6 then<br />
				fileContents.Writeline &quot;insDoc(aux4, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=7 then<br />
				fileContents.Writeline &quot;insDoc(aux5, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=8 then<br />
				fileContents.Writeline &quot;insDoc(aux6, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			elseif folderlev(i)=9 then<br />
				fileContents.Writeline &quot;insDoc(aux7, gLnk(&quot; &amp; chr(34) &amp; &quot;S&quot; &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; pxName(i) &amp; chr(34) &amp; &quot;,&quot; &amp; chr(34) &amp; FolderPath(i) &amp; &quot;))&quot;<br />
			end if<br />
		'	end if</p>
<p>		end if<br />
	wend</p>
<p>End Sub<br />
[/sourcecode]</p>
